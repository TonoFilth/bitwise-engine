#pragma once

#include <cstdio>   // sscanf
#include <cstring>  // strcpy
#include <utility>  // std::forward

#if defined(BW_PLATFORM_ANDROID)
    #include <stdarg.h> // va_list
#else
    #include <cstdarg>  // va_list
#endif

#if defined(BW_PLATFORM_LINUX) || defined(BW_PLATFORM_WEB)
#   include <strings.h> // strcasecmp()
#endif

#include "bitwise/core/macros.h"
#include "bitwise/core/assert.h"

namespace bw
{
////////////////////////////////////////////////////////////////////////////////
/// \brief Brief description.
/// \todo Write brief description.
////////////////////////////////////////////////////////////////////////////////
namespace cstring
{
	////////////////////////////////////////////////////////////////////////////
	/// \brief Brief description.
	/// \todo Write brief description.
	////////////////////////////////////////////////////////////////////////////
    BW_INLINE BW_API void copy(char* buffer, size_t bufferSize, const char* str);

	////////////////////////////////////////////////////////////////////////////
	/// \brief Brief description.
	/// \todo Write brief description.
	////////////////////////////////////////////////////////////////////////////
    BW_INLINE BW_API void concatenate(char* buffer, size_t bufferSize, const char* str);

    ////////////////////////////////////////////////////////////////////////////
	/// \brief Brief description.
	/// \todo Write brief description.
	////////////////////////////////////////////////////////////////////////////
    BW_API bool contains(const char* str, const char needle);

    ////////////////////////////////////////////////////////////////////////////
	/// \brief Brief description.
	/// \todo Write brief description.
	////////////////////////////////////////////////////////////////////////////
    BW_API bool contains(const char* str, const char* needle);

    ////////////////////////////////////////////////////////////////////////////
	/// \brief Brief description.
	/// \todo Write brief description.
	////////////////////////////////////////////////////////////////////////////
    BW_INLINE BW_API bool equals(const char* str1, const char* str2);

	////////////////////////////////////////////////////////////////////////////
	/// \brief Brief description.
	/// \todo Write brief description.
	////////////////////////////////////////////////////////////////////////////
    BW_INLINE BW_API bool equals_ignore_case(const char* str1, const char* str2);

    ////////////////////////////////////////////////////////////////////////////
	/// \brief Brief description.
	/// \todo Write brief description.
	////////////////////////////////////////////////////////////////////////////
    template <typename ...Args>
    size_t format(char* buffer, size_t bufferSize, const char* format, Args&& ...args);

    ////////////////////////////////////////////////////////////////////////////
	/// \brief Brief description.
	/// \todo Write brief description.
	////////////////////////////////////////////////////////////////////////////
    BW_INLINE BW_API size_t cformat(char* buffer, size_t bufferSize, const char* format, ...);

	////////////////////////////////////////////////////////////////////////////
	/// \brief Brief description.
	/// \todo Write brief description.
	////////////////////////////////////////////////////////////////////////////
    BW_INLINE BW_API size_t cformat_va(char* buffer, size_t bufferSize, const char* format, va_list args);

    ////////////////////////////////////////////////////////////////////////////
	/// \brief Brief description.
	/// \todo Write brief description.
	////////////////////////////////////////////////////////////////////////////
    BW_INLINE BW_API size_t length(const char* str);

    ////////////////////////////////////////////////////////////////////////////
	/// \brief Brief description.
	/// \todo Write brief description.
	////////////////////////////////////////////////////////////////////////////
    BW_API bool replace(char* str, char needle, char replacement);

	////////////////////////////////////////////////////////////////////////////
	/// \brief Brief description.
	/// \todo Write brief description.
	////////////////////////////////////////////////////////////////////////////
    template <typename ...Args>
    BW_INLINE BW_API size_t scan_cformat(const char* str, const char* format, Args&& ...args);

    ////////////////////////////////////////////////////////////////////////////
	/// \brief Brief description.
	/// \todo Write brief description.
	////////////////////////////////////////////////////////////////////////////
    BW_API bool starts_with(const char* str, const char needle);

    ////////////////////////////////////////////////////////////////////////////
	/// \brief Brief description.
	/// \todo Write brief description.
	////////////////////////////////////////////////////////////////////////////
    BW_API bool starts_with(const char* str, const char* needle);

    ////////////////////////////////////////////////////////////////////////////
	/// \brief Brief description.
	/// \todo Write brief description.
	////////////////////////////////////////////////////////////////////////////
    BW_API bool ends_with(const char* str, const char needle);

    ////////////////////////////////////////////////////////////////////////////
	/// \brief Brief description.
	/// \todo Write brief description.
	////////////////////////////////////////////////////////////////////////////
    BW_API bool ends_with(const char* str, const char* needle);

	////////////////////////////////////////////////////////////////////////////
	/// \brief Brief description.
	/// \todo Write brief description.
	////////////////////////////////////////////////////////////////////////////
    template <typename T>
    void to_string(const T& value, char* buffer, size_t bufferSize, const char* formatOptions = "");

    ////////////////////////////////////////////////////////////////////////////
	/// \brief Brief description.
	/// \todo Write brief description.
	////////////////////////////////////////////////////////////////////////////
    template <typename T>
    void to_string(const T* value, char* buffer, size_t bufferSize, const char* formatOptions = "");

    ////////////////////////////////////////////////////////////////////////////
	/// \brief Brief description.
	/// \todo Write brief description.
	////////////////////////////////////////////////////////////////////////////
    BW_INLINE BW_API void truncated_copy(char* buffer, size_t bufferSize, const char* str);

    ////////////////////////////////////////////////////////////////////////////
	/// \brief Brief description.
	/// \todo Write brief description.
	////////////////////////////////////////////////////////////////////////////
    BW_INLINE BW_API void truncated_concatenate(char* buffer, size_t bufferSize, const char* str);

    ////////////////////////////////////////////////////////////////////////////
	/// \brief Brief description.
	/// \todo Write brief description.
	////////////////////////////////////////////////////////////////////////////
    BW_INLINE BW_API size_t truncated_cformat(char* buffer, size_t bufferSize, const char* format, ...);

    ////////////////////////////////////////////////////////////////////////////
	/// \brief Brief description.
	/// \todo Write brief description.
	////////////////////////////////////////////////////////////////////////////
    BW_INLINE BW_API size_t truncated_cformat_va(char* buffer, size_t bufferSize, const char* format, va_list args);

}   // namespace cstring
}   // namespace bw

// -----------------------------------------------------------------------------
//  Inline functions
// -----------------------------------------------------------------------------
#include "bitwise/core/cstring.inl"

// -----------------------------------------------------------------------------
//  Platform implementation
// -----------------------------------------------------------------------------
#if defined(BW_PLATFORM_WINDOWS)
#   include "bitwise/core/platform/windows/cstring.inl"
#else
#   include "bitwise/core/platform/unix/cstring.inl"
#endif

////////////////////////////////////////////////////////////////////////////////
/// \namespace bw::cstring
/// \ingroup core
///
/// \details Detailed description.
/// \todo Write detailed description.
////////////////////////////////////////////////////////////////////////////////